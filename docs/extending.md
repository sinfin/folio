# Extending & Customization

This chapter collects all the official Folio generators and advanced hooks so you can customise the engine safely and keep your codebase maintainable.

---

## Generators Overview

The table below lists the generator namespaces found in `lib/generators/folio/` and what they create.

| Generator | Command example | Purpose |
|-----------|-----------------|---------|
| `install` | `rails generate folio:install` | Adds Folio to a Rails project, migrations & initializer |
| `atom` | `rails generate folio:atom Text` | Creates a new CMS block (Atom) with model & component |
| `component` | `rails generate folio:component Hero` | Creates a standalone ViewComponent |
| `console:scaffold` | `rails generate folio:console:scaffold Article` | Admin console CRUD scaffold |
| `file` | `rails generate folio:file MyCustomFile` | Custom file type model |
| `file_placement` | `rails generate folio:file_placement MyPlacement` | Custom file placement model |
| `mailer` | `rails generate folio:mailer Newsletter` | Mailer with Slim/ERB templates & tests |
| `page_singleton` | `rails generate folio:page_singleton ContactPage` | Singleton page model & admin config |
| `prepared_atom` | `rails generate folio:prepared_atom Cta` | Atom pre-configured with test data |
| `search` | `rails generate folio:search Article` | Adds PG full-text search support |
| `traco` | `rails generate folio:traco title content` | Adds Traco translated fields to a model |
| `ui` | `rails generate folio:ui Alert` | Lightweight UI component scaffold |
| `cell` | `rails generate folio:cell LegacyWidget` | Legacy Trailblazer Cell (avoid for new code) |
| `blog` | `rails generate folio:blog` | Turnkey blog section (posts, categories) |
| `assets` | `rails generate folio:assets` | Adds default SASS, JS & images |
| `pg_search_index_migration` | `rails generate folio:pg_search_index_migration` | Adds indexes for pg_search |
| `email_templates` | `rails generate folio:email_templates` | Adds default email templates |

*Run `rails generate` without arguments to see all generators and options.*

---

## Overriding Engine Code

Folio follows the standard Rails engine override approach:

1. Create a file in `app/overrides/` mirroring the path you want to override.
2. Define your subclass or module patch.
3. Rails autoloader will pick your version first.

Example overriding `Folio::User` validations:
```ruby
# app/overrides/folio/user.rb
Folio::User.class_eval do
  validates :nickname, uniqueness: true, allow_blank: true
end
```

---

## Custom Initializers

Place configuration tweaks in `config/initializers/folio.rb` (generated by `folio:install`). Keep everything in one file to ease upgrades.

---

## Adding to Admin Sidebar

After generating a console scaffold, register it:
```ruby
# config/initializers/folio.rb
config.folio_console_sidebar_link_class_names ||= []
config.folio_console_sidebar_link_class_names << "Folio::Console::ArticlesController"
```

## AASM Extensions

Folio includes `Folio::AasmMailer` for sending notifications when an AASM state changes.
```ruby
class Order < ApplicationRecord
  include AASM

  aasm do
    state :pending, initial: true
    state :paid

    event :pay do
      transitions from: :pending, to: :paid, after_commit: -> { Folio::AasmMailer.order_paid(self).deliver_later }
    end
  end
end
```
The generator `rails generate folio:mailer Aasm` can scaffold a mailer for a specific model.

## Maintenance Rake Tasks

Folio ships with several helper tasks located in `lib/tasks/`:

| Task | Purpose |
|------|---------|
| `rake folio:file:fill_missing_metadata` | Extract missing EXIF/IPTC metadata for all files |
| `rake folio:session_attachments:clear_unpaired` | Remove unused temporary attachments |
| `rake folio:developer_tools:idp_fill_up_site_to_folio_records` | Back-fill `site_id` on legacy records |
| `rake folio:developer_tools:idp_split_users_to_sites` | Split users to individual sites after cross-domain auth removal |

Run `rake -T folio` to list everything available.


---

## Navigation

- [← Back to Overview](overview.md)
- [← Back to Upgrade & Migration](upgrade.md)
- [Next: FAQ →](faq.md)

---

*Refer to each generator's `USAGE` file for detailed options.*