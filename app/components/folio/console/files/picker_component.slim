.f-c-files-picker[
  data=data
  class="form-group"
  class="f-c-files-picker--as-#{@file_klass.human_type}"
  class=(@darker ? "f-c-files-picker--darker" : nil)
  class="f-c-js-atoms-placement-setting"
]
  = @f.label @placement_key, required: @required

  = @f.simple_fields_for @placement_key, file_placement do |fp|
    = fp.hidden_field :id, data: stimulus_target("idInput")

    = fp.hidden_field :_destroy,
                      value: fp.object.marked_for_destruction? ? "1" : "0",
                      disabled: !fp.object.marked_for_destruction?,
                      data: stimulus_target("destroyInput")

    = fp.hidden_field :file_id,
                      data: stimulus_target("fileIdInput")

    .f-c-files-picker__inner
      .f-c-files-picker__content data=stimulus_target("content")
        - if file_placement && file_placement.file && !file_placement.marked_for_destruction?
          = render(content_component)

      .f-c-files-picker__btn-wrap
        = render(Folio::Console::Ui::ButtonComponent.new(class_name: "f-c-files-picker__btn",
                                                         variant: :success,
                                                         icon: :plus,
                                                         data: stimulus_action(click: 'onBtnClick')))

      span.folio-loader.f-c-files-picker__loader

    - if hint = hint_for(fp)
      small.f-c-files-picker__hint.form-text.text-muted
        = hint

    - if @file_klass.human_type == "image"
      .f-c-files-picker__in-place-inputs.small.text-muted
        = render(Folio::Console::Ui::InPlaceInputComponent.new(attribute: :description,
                                                               record: fp.object,
                                                               f: fp,
                                                               compact: true,
                                                               textarea: true,
                                                               data: stimulus_target('description'),
                                                               value_line_clamp: 2,
                                                               value_prefix: "#{t('.description')}:"))

        = render(Folio::Console::Ui::InPlaceInputComponent.new(attribute: :alt,
                                                               record: fp.object,
                                                               f: fp,
                                                               compact: true,
                                                               textarea: true,
                                                               data: stimulus_target('alt'),
                                                               value_line_clamp: 2,
                                                               value_prefix: "#{t('.alt')}:"))
